#include <algorithm>
#include <iostream>
#include <vector>

using namespace std;


char grid[][151] =

{

R"(	    /-----------------------\                                   /-------------\                                                                      )",
R"(    |            /----------+-----------------------------------+----\        |                                                /-----------\          )",
R"(    |            |        /-+---------------------\             |    |        |             /----------------------------------+------\    |          )",
R"(    |            |        | |   /-----------------+-------------+---\|        |             |                                  |      |    |          )",
R"(    |         /--+--------+-+--\|  /--------------+-------------+---++--\     | /-----------+----------------------------------+------+---\|          )",
R"( /--+---------+--+--------+-+--++--+--------------+-------------+---++--+-----+-+-----------+------------\                     |      |   ||          )",
R"( |  |         |  |        | |  ||  |              |            /+---++--+-----+-+-----------+------------+---------------------+------+---++-------\  )",
R"( |  |         |  |        | |  ||  |         /----+------------++\  ||  |     | |           |            |            /--------+------+--\||       |  )",
R"( |  |         |  |       /+-+--++--+---------+----+------------+++--++--+---\ | |           |            |            |        |      |  |||       ^  )",
R"( |  |         |  |   /---++-+--++--+---------+--\ |            |||  ||  |   | | |      /----+------------+------------+--------+------+--+++----\  |  )",
R"( |  |         |  |   |/--++-+--++--+---------+--+-+------------+++-\||  |   | | |      |    |            |            |        |      |  |||    |  |  )",
R"( |  |         | /+---++--++-+--++--+--------\|  | |            |\+-+++--+---+-/ |      |    |            |            |        |      |  |||    |  |  )",
R"(/+--+---------+-++---++--++-+--++--+--------++--+-+-<----------+-+-+++--+---+---+------+----+----------\ |            |        |      |  |||    |  |  )",
R"(||  |         | ||   ||  || |  ||  |       /++--+-+------------+-+-+++--+---+---+------+----+----------+-+------------+-\      |      |  |||    |  |  )",
R"(||  |         | ||   ||  || |  ||  |    /--+++--+-+------------+-+-+++--+---+\  |      |    |      /---+-+------------+-+------+------+-\|||    |  |  )",
R"(||  |         | ||   ||  || |  || /+----+--+++--+-+\          /+-+-+++--+-\ ||  |      |    |      |   | |     /------+-+-\    |      | ||||    |  |  )",
R"(||/-+---------+\||   ||  || |  || ||    |  |||  | ||          || | |||  | | ||  |      |    |      |   | |  /--+------+-+-+\   |      | ||||    |  |  )",
R"(||| |         ||||   ||  || |  || ||    |  |||  | ||      /---++-+-+++--+-+-++--+------+----+------+-\ | |  |  |      | | ||   |      | ||||    |  |  )",
R"(||| |   /-----++++---++--++-+--++-++----+--+++--+-++------+---++-+-+++--+-+-++--+------+----+------+-+-+-+-\|  |      \-+-++---+------+-+/||    |  |  )",
R"(||| |   |     ||||   ||  || |  |\-++----+--+++--+-++------+---++-+-+/|  | | ||  |      |    |      | | | | ||  |        | ||   |      | | ||    |  |  )",
R"(||| |   |     ||||  /++--++-+--+--++----+--+++--+-++----->+---++-+-+-+--+-+-++--+------+----+------+-+-+-+-++--+--------+-++--\|      | | ||    |  |  )",
R"(||| |   |     ||||  |||  |\-+--+--++----+--+++--+-/|/-----+---++-+-+-+--+-+-++--+------+----+------+\| | | ||  |        | ||  ||      | | ||    |  |  )",
R"(||| |   |     ||||  |||  |  |  |  ||    |  |||  |  ||     |   || |/+-+--+-+-++--+------+----+---\ /+++-+-+-++--+-----\  | ||  ||      | | ||    |  |  )",
R"(||| |   |     |||| /+++--+--+--+--++----+--+++--+--++-----+---++-+++-+--+-+\||  |      |    |   | |||| | | ||  | /---+--+-++--++-----\| | ||    |  |  )",
R"(||| |   |     |||| ||||  |  |  |  ||  /-+--+++--+--++-----+---++-+++-+--+-++++--+------+----+---+-++++\| | ||  | |   |  | ||  ||     || | ||    |  |  )",
R"(||| |   |     |||| ||||  |  |  |  \+--+-+--+++--+--/|     |   |\-+++-+--+-++++--+------+----+---+-++++++-+-++--+-+---+--+-++--++-----++-+-++----+--/  )",
R"(||| | /-+-----++++-++++--+--+--+---+--+-+--+++--+---+-----+---+--+++-+--+-++++--+\     |    |   | |||||| | ||  | |   |  | ||  ||     || | ||    |     )",
R"(||| | | |     |||| ||||  |  |  |   |  | |  |||  |   |     |   |  ||| |/-+-++++--++-----+----+---+-++++++-+-++--+-+---+--+-++--++-----++-+\||    |     )",
R"(||| | | |     |||| ||||  |  |  |   |  | |  |||  |   |     |   |  ||| || | ||||  ||     |    |   | |||||| | ||  | |   |  | ||  ||     || ||||    |     )",
R"(||| | | |    /++++-++++--+--+--+---+--+-+--+++--+---+-----+---+--+++-++-+-++++--++-----+----+---+-++++++-+-++\ | |   |  | ||  ||     || ||||    |     )",
R"(||| | | |    ||||| ||||  |  |  |   |  | |  |||  |   |     |   |  ||| || | ||||  ||     |    |   | |||||| | ||| | |   |  | ||  ||     || ||||    |     )",
R"(||| | | |    ||||| ||||  |  |  |   |  | \--+++--+---+-----+---+--+++-++-+-+++/  ||    /+----+---+-++++++-+-+++-+-+\  |  | ||  ||     || ||||    |     )",
R"(||| | | |    ||||| ||||  |  |  |   \--+----+++--+---+-----+---+--+++-++-/ |||   ||    ||    |   | |||||| | ||| | \+--+--+-++--++-----/| ||||    |     )",
R"(||| | | |    ||||| ||||  |  |  |      |    |||  |   |     |   |  ||| ||  /+++---++----++----+---+-++++++-+-+++-+--+--+--+-++\ ||      | ||||    |     )",
R"(||| | | |    ||||| |\++--+--+--+------+----+++--+---+-----+---+--+++-++--++++---++----++----+---+-++++++-+-+++-+--+--+--+-+++-/|      | ||||    |     )",
R"(||| | | |    ||||| | ||  |  |  |      |    |||  |   |     |   |  ||| ||  ||||   ||    ||    |   | ||||||/+-+++-+--+-\|  | |||  |      | ||||    |     )",
R"(||| | | |    ||||| | ||  |  |  |      \----+++--+---+-----+---+--+++-++--++++---++----++----+---+-++++/||| |\+-+--+-++--+-+/|  |      | ||||    |     )",
R"(||| | | |    ||||| | ||  |  |  |           |||/-+---+-----+---+--+++-++--++++---++----++----+---+-++++-+++-+-+-+--+-++--+-+<+--+------+-++++-\  |     )",
R"(||| | | |/---+++++-+-++--+--+--+---------\ |||| |   |     |   |  ||| ||  ||||   ||    ||    |   | |||| ||| | | |  | ||  | | |  |      | |||| |  |     )",
R"(||| | | ||   ||||| | ||  |  |  |         |/++++-+---+-----+---+--+++-++--++++---++----++----+---+-++++-+++-+-+-+--+-++--+-+-+--+------+\|||| |  |     )",
R"(||| | | ||   ||||| | ||  |  |  |        /++++++-+---+-----+---+--+++-++--++++---++----++----+---+-++++-+++-+-+\|  | ||  | | |  |      |||||| |  |     )",
R"(||| | | ||   ||||| | ||  |/-+--+--------+++++++-+---+-----+---+-\||| ||  |||| /-++----++\   |   | |||| ||| | |||  | ||  | | |  |      |||||| |  |     )",
R"(||| | | ||   ||||| | ||  || |  |        ||||||| |   |     |  /+-++++-++--++++-+-++----+++---+---+-++++-+++-+-+++--+-++--+-+-+--+--\   |||||| |  ^     )",
R"(||| | | ||   ||||| | ||  || |  |        ||||||| |   |     |  || ||||/++>-++++-+-++----+++---+---+-++++-+++-+-+++--+-++--+-+-+--+--+---++++++-+--+\    )",
R"(||| | | ||   ||||| | ||  || |  |        ||||||| |   |    /+--++-+++++++--++++-+-++----+++---+---+-++++-+++-+-+++--+-++--+-+-+--+\ |   |||||| |  ||    )",
R"(||| | | ||/--+++++-+-++--++-+--+--------+++++++-+---+----++--++-+++++++--++++-+-++----+++--\|   | |||| ||| | ||\--+-++--+-/ |  || |   |||||| |  ||    )",
R"(||| | | |||  ||||| | ||  || |  |        ||||||| |   |    ||  || |||||||  |||| | ||    |||  ||   | |||| ||| | ||   | ||  |   |  || |   |||||| |  ||    )",
R"(||| | | |||  ||||| | ||  || |  |     /--+++++++-+---+----++--++-+++++++--++++-+-++----+++--++---+-++++-+++-+-++---+-++--+--\|  || |   |||||| |  ||    )",
R"(||| \-+-+++--+++++-+-++--++-/  |     |  ||||||| |   |    |\--++-+++++++--++++-+-++----+++--++---+-+++/ ||| | ||   | ||  |  |v  || |   |||||| |  ||    )",
R"(|||   | |||  ||||| | |\--++----+-----+--+++++++-+---+----+---++-+++/|||  |||| | ||    |||  ||   | |||  ||| | ||   | ||  |  ||  || |   |||||| |  ||    )",
R"(|||   | |||  ||||| | |   ||    |   /-+--+++++++-+---+----+---++-+++-+++--++++-+-++----+++--++---+-+++--+++-+-++---+-++--+--++-\|| |   |||||| |  ||    )",
R"(|||   | |||  ||||| |/+---++----+---+-+--+++++++-+---+----+---++-+++-+++--++++-+-++----+++\ ||   | |||  ||| | ||   | ||  |  || ||| |   |||||| |  ||    )",
R"(|||   | |||  ||||| |||   ||    |   | |  ||||||| |   |    |   || ||| |||  |||| | ||    |||| ||   | |||  ||| | ||   | ||  |  || |\+-+---+++++/ |  ||    )",
R"(|||   | |||  ||||| |||   ||    |   | |  ||||||| |   |    |   || ||| |||  |||| | ||    |||| ||   | |||  ||| | ||   | ||  |  || | | |   |||||  |  ||    )",
R"(|||  /+-+++--+++++\|||   ||    |   | |  ||||||| |   |    |/--++-+++-+++--++++-+-++----++++\||   | |||  ||| | ||   | ||  |  || | | |   |||||  |  ||    )",
R"(|||  || |||  |||||||||   ||    |   | |  ||||||| |   |    ||  || ||| |||  |||v | ||    |||||||  /+-+++--+++-+-++---+-++--+--++-+-+-+---+++++--+--++\   )",
R"(|||  || |||  |||||||||   ||    |   | |  ||||||| |   |    ||/-++-+++-+++--++++-+-++----+++++++--++-+++--+++-+-++---+-++--+--++-+-+-+\  |||||  |  |||   )",
R"(|||  || |||/-+++++++++---++----+---+-+--+++++++-+---+---\||| || ||| |||  |||| | ||    |||||||  || |||  ||| | ||   | ||  |  || | | ||  |||||  |  |||   )",
R"(|||  || |||| |||||||||   ||    |   | |  ||||||| |  /+---++++-++-+++-+++\ |||| | ||    |||||||  || |||  ||| | ||   | ||  |  || | | ||  |||||  |  |||   )",
R"(|||  || |||| |||||||||   ||    |   | |  ||||||| |  ||   |||| || ||| |||| |||| | ||    |||||||  ||/+++--+++-+-++---+-++--+--++-+-+-++--+++++--+--+++--\)",
R"(|||  || |||| |||||||||   ||    |   | |  ||||||| |  ||   |||| || ||| |||| |||| | ||    |||||||  ||||||  ||| | ||   | || /+--++-+-+-++--+++++--+\ |||  |)",
R"(|||  || |||| |||||||||   ||    |   | |  ||||||| |  ||   |||| || ||| |||| |||| | ||    |||||||  ||||||  ||| | ||   | || ||  || | | ||  |||||  || |||  |)",
R"(|||  || |||| |||||||||   ||    | /-+-+--+++++++-+--++---++++-++-+++-++++-++++-+-++----+++++++--++++++--+++-+-++---+-++-++--++-+-+\||  |||||  || |||  |)",
R"(|||  || |||| |||||||||/--++----+-+-+-+--+++++++-+--++---++++-++-+++-++++-++++-+-++----+++++++--++++++--+++-+-++-\ | || ||  || | ||||  |||||  || |||  |)",
R"(|||  || |||| ||||||||||  || /--+-+-+-+--+++++++-+--++---++++-++-+++-++++-++++-+-++<---+++++++\ ||||||  ||| | || | | || ||  || | ||||  |||||  || |||  |)",
R"(|||  ||/++++-++++++++++--++-+--+\| | |  ||||||| |/-++---++++-++-+++-++++-++++-+-++----++++++++-++++++-\||| | || | | || ||  || | ||||  |||||  || |||  |)",
R"(|||  ||||||| \+++++++++--++-+--+++-+-+--+++++++-++-++---++++-++-+++-++++-++++-+-++----++++++++-++++++-++++-+-/| | | || ||  || | ||||  |||||  || |||  |)",
R"(|||  |||||\+--+++++++++--++-+--+++-+-+--+++++++-++-++---++++-++-+++-++++-++++-+-++----+++++/|| \+++++-++++-+--+-+-+-++-++--++-+-++++--+++++--++-++/  |)",
R"(|||  ||||| |  |||||||||  || |  ||| \-+--+++++++-++-++---++++-++-+++-++++-++++-+-++----+++++-++--+++++-++++-+--+-+-+-++-++--++-/ ||||  |||||  || ||   |)",
R"(|||  ||||| |  ||||||\++--++-+--+++---+--+++++++-++-++---++++-++-+++-++++-++++-+-++----+++/| ||  ||||| |||| |  | | | || ||  ||   ||||  |||||  || ||   |)",
R"(|||  ||||| |  |||||| ||  || |/-+++---+--+++++++-++-++---++++-++-+++-++++-++++\| ||    ||| | ||  ||||| |||| |  | | | || ||  ||   ||||  |||||  || ||   |)",
R"(|||  |\+++-+--++++++-++--++-++-+++---+--+++++++-++-++---++++-++-+++-++++-++++++-+/    ||| | ||  |||||/++++-+--+-+-+-++-++--++\  ||||  |||||  || ||   |)",
R"(|||  | ||| |  |||||| ||  || || |||   |  ||||||| || \+---++++-++-+++-+++/ |||||| |     |\+-+-++--++++++++++-+--+-+-+-++-++--+++--++++--+++++--++-/|   |)",
R"(|||  | ||| |  |||||| ||  || ||/+++---+--+++++++-++--+---++++-++-+++-+++--++++++-+-----+-+-+-++--++++++++++-+--+-+-+-++-++--+++-\||||  |||||  ||  |   |)",
R"(|||  | ||| |  |||||| ||  || ||||||   |  ||||||| ||  |   |||| || ||| |||/-++++++-+-----+-+-+-++--++++++++++-+-\| | | || \+--+++-+++++--+++++--+/  |   |)",
R"(|||  | ||| \--++++++-++--++-++++++---+--+++++++-++--+---/||| |\-+++-++++-+/|||| |     | | | ||/-++++++++++-+-++-+-+-++--+--+++-+++++--+++++\ |   |   |)",
R"(|||/-+-+++----++++++-++--++-++++++-\ |/-+++++++-++--+----+++\|  ||| |||| | |||| |     | | | ||| |||||||||| | || | | ||  |  ||| |||||  |||||| |   |   |)",
R"(|||| | |||    |||||| ||  || |||||| | || |||||\+-++--+----+++++--+/| |||| \-++++-+-----+-+-+-+++-++++++++++-+-++-+-+-++--+--+/| |||||  |||||| |   |   |)",
R"(|||| | |||    |||||| ||  || |||||| | || ||||| | ||  |    |||||  | | ||\+---++++-+-----+-+-+-+++-++++++++++-+-++-+-+-++--+--+-+-+++++--+++/|| |   |   |)",
R"(|||| | |||    |||||| ||  || |||||| | || ||||| | ||  |    |||||  | | || |   |||| |     | | | \++-++++++++++-+-++-+-+-++--+--+-+-+++++--/|| || |   |   |)",
R"(|||| | |||    |||||| ||  || |||||| | || ||||| | ||  |    |||||  | | || |   |||| |     | | |  || ||\+++++++-+-++-+-+-+/  |  | | |||||   || || |   |   |)",
R"(\+++-+-+++----++++++-++--++-++++++-+-++-+++++-+-++--+----+++++--+-+-++-+---++++-+-----+-+-+--++-++-++++/|| | || | | |   |  | | |||||   || || |   |   |)",
R"( ||| | |||    |||||| ||  || \+++++-+-++-+++++-+-++--+----+++++--+-+-++-+---++++-+-----+-+-+--/| || |||| || | || | | |   |  | | |||||   || || |   |   |)",
R"( ||| | |||    |||||| ||  ||  ||||| | || ||||| | ||/-+----+++++--+-+-++-+---++++-+-----+-+-+---+-++-++++-++-+-++-+-+-+---+--+-+-+++++\  || || |   |   |)",
R"( ||| | |||    |||||| ||  ||  ||||| | || ||||| | ||| |    |||||  | | || |   |||| |     | | |   | || |||| || | || | | |   |  | | ||||||  || || |   |   |)",
R"( ||| | \++----++++++-++--++--+++/| | || ||||| | ||| |    ||\++--+-+-++-+---++++-+-----+-+-+---+-++-++++-++-+-++-+-+-+---+--+-+-++++/|  || || |   |   |)",
R"( ||| |  ||    |||||| ||  ||  ||| | | || ||||| | ||| |    || ||  | | || |   |||| |     | | |   | || ||\+-++-+-++-+-+-+---+--+-/ |||| |  || || |   |   |)",
R"( ||| |  ||    |||||| ||  ||  ||| | | || ||||| | ||| |    || ||  | \-++-+---++++-+-----+-+-+---+-/| || | || | || | | |   |  |   |||| |  || || |   |   |)",
R"( ||| |  ||    |||||| ||  \+--+++-+-+-++-+++++-+-+++-+----++-++--+---++-+---+/|| |     | | |   \--+-++-+-++-+-++-+-+-+---+--+---++++-+--++-+/ |   |   |)",
R"( ||| |  ||    |||||| ||   |  ||| \-+-++-+++++-+-+++-+----++-++--+---++-+---+-++-+-----+-+-+------+-++-+-++-+-++-+-+-+---+--+---++/| |  || |  |   |   |)",
R"( ||| |  ||    |||||| ||/--+--+++---+-++-+++++-+-+++-+----++-++--+---++-+---+-++-+-----+-+-+------+-++-+-++-+-++-+-+\|   |  |   || | |  || v  |   |   |)",
R"( ||| | /++----++++++-+++--+-\|||   | \+-+++++-+-+++-+----++-++--+---++-+---+-++-+-----+-+-+------+-++-+-++-+-++-+-+++---+--/   || | |  || |  |   |   |)",
R"( ||| | |||    |||||| |||  | ||||   |  | ||||| | ||| |    || ||  |   || |   | ||/+-----+-+-+------+-++-+-++-+-++-+-+++---+------++-+-+--++-+--+---+-\ |)",
R"( \++-+-+++----++++++-+++--+-++++---+--+-+++++-+-+++-+----++-++--+---++-+---+-++++-----+-+-+------+-++-+-+/ | || | |||   |      || | |  || |  |   | | |)",
R"(/-++-+-+++----++++++-+++--+-++++--\|  | ||||| | ||| |    \+-++--+---++-+---+-++++-----+-+-+------+-++-+-+--+-++-+-+++---+------+/ | |  || |  |   | | |)",
R"(| || | |||    |||||| |||  | ||||  ||  | ||||| | ||| |     \-++--+---++-+---+-++++-----+-+-/      | || | |  | ||/+-+++---+------+--+-+--++-+--+---+\| |)",
R"(| || | |^|    |||||| |||  | ||||  ||  | ||||| | ||| |       || /+---++-+---+-++++-----+-+--------+-++-+-+--+-++++-+++---+------+--+-+--++-+--+\  ||| |)",
R"(| || | |||    \+++++-+++--+-+++/  ||  |/+++++-+-+++-+-\     || ||   || |   | ||||   /-+-+--------+-++-+-+--+-++++-+++---+------+--+-+--++-+-\||  ||| |)",
R"(| || | |||     ||||| |||  | |||   ||  ||||||| | ||| | |     || ||   || |   | |||\---+-+-+--------+-++-+-+--+-++++-+++---+------+--+-+--++-/ |||  ||| |)",
R"(| || | |||    /+++++-+++--+-+++---++--+++++++-+-+++-+-+-----++-++---++-+---+-+++--\ | | |        | || | |  |/++++-+++---+------+--+-+--++-\ |||  ||| |)",
R"(| || | |||  /-++++++-+++--+-+++---++--+++++++-+-+++-+-+-----++-++---++-+\  | |||  | | | |        | \+-+-+--++++++-+++---+------+--+-+--+/ | |||  ||| |)",
R"(| || | |||  | |||||\-+++--+-+++---++--+++++++-+-+++-+-+-----++-++---++-++--/ |||  |/+-+-+------\ |  | | |  |||||| |||   |      |  | |  |  | |||  ||| |)",
R"(| |\-+-+++--+-+++++--+++--+-+++---+/  \++++++-+-+++-+-+-----/| ||   || ||    |||  ||| | |      | |  | | |  |||||| |||   |      |  | |  |  | |||  ||| |)",
R"(| |  | |||  | |||\+--+++--+-+++---+----++++++-+-+++-+<+------+-++---+/ \+----+++--+++-+-+------+-+--+-+-+--++/||| |||   |      |  | |  |  | |||  ||| |)",
R"(| |  | |||  | ||| |  |||  | |||   |    |||||| | ||| | |      | ||   |   |    |||  ||| | |      | |  | | |  || ||| |||   |      |  | |  |  | |||  ||| |)",
R"(\-+--+-+++--+-+++-+--+++--+-+++---/    |||||| | ||| | |      | ^|   |   |    |||  ||| | |      | |  | | \--++-+++-++/   |      |  | |  |  | |||  ||| |)",
R"(  |  | |||  | ||| |  |||  | |||        |||||| | ||| | |      | ||   \---+----+++--+++-+-+------+-+--+-+----++-+++-++----+------+--+-+--+--+-+++--/|| |)",
R"(  |  | |||  | ||| |  |||  | |||        ||||\+-+-+++-+-+------+-++-------+----+++--+++-+-+------+-+--+-+----++-+++-++----/      |  | |  |  | |||   || |)",
R"(  |  | \++--+-+++-+--+++--+-/||        |||| | | ||| | |      | ||       |    |||  ||| | |      | |  | |    || ||| ||           |  | |  |  | |||   || |)",
R"(  |  |  ||  | ||| |  |||  |  ||        |||| | | ||| | |      | ||       |    |||  ||| | |   /--+-+--+-+----++-+++-++-----------+--+<+--+-\| |||   || |)",
R"(  |  |  ||  | ||| |  |||  |  ||        |\++-+-+-+++-+-+------+-++-------+----+++--+++-+-+---+--+-+--+-+----++-/|| ||           |  | |  | || |||   || |)",
R"(  |  |  ||  | ||| |  |||  |  ||        | || | | ||| | |  /---+-++-------+----+++--+++-+-+---+--+-+--+-+----++--++-++-----------+--+-+--+-++\|||   || |)",
R"(  |  |  ||  |/+++-+--+++--+--++--------+-++-+-+-+++-+-+--+---+-++-------+----+++--+++-+-+\  |  | |  | |    ||  || ||           |  | |  | ||||||   || |)",
R"(  |  \--++--+++++-/  |||  |  ||        | || | | ||| | |  |   | ||       |    ||\--+++-+-++--+--+-+--+-+----++--++-++-----------+--+-+--+-++++++---+/ |)",
R"(  |     ||  |||||    |||  |  ||        | || | \-+++-+-+--+---+-++-------+----++---+++-+-++--+--+-+--+-+----++--++-++-----------+--+-+--+-++++/|   |  |)",
R"(  |     ||  |||||    \++--+--++--------+-++-+---/|| | |  |   | ||       |/---++---+++-+-++--+--+-+--+-+----++--++-++-----------+\ | |  | |||| |   |  |)",
R"(  \-----++--+++/|     ||  |  ||        | || |    || | |  |   | ||       ||/--++---+++-+-++--+--+-+--+-+----++--++-++-\         || | |  | |||| |   |  |)",
R"(        ||  ||| \-----++--+--++--------+-++-/    || \-+--+---+-++-------+++--++---+++-+-++--+--+-+--/ |    ||  || || |         || | |  | |||| |   |  |)",
R"(        ||  |||       ||  |  ||        | |\------++---+--+---+-++-------+++--++---+++-+-++--+--+-+----+----++--++-++-+---------++-+-+--/ |||| |   |  |)",
R"(        \+--+++-------++--+--++--------+-+-------++---+--+---+-++-------+++--++---+++-+-++--+--+-+----+----/|  || || |         || | |    |||| |   |  |)",
R"(         |  |||       ||  |  ||        | |       ||   |  \---+-++-------+++--++---+++-+-++--+--+-+----+-----+--++-++-+---------++-+-+----++/| |   |  |)",
R"(         |  |||       ||  |  ||        | |       ||   |      | ||       |||  ||   ||| | ||  |  | |    |     \--++-++-+---------++-+-+----+/ | |   |  |)",
R"(         |  |||    /--++--+--++--------+-+-------++---+------+-++-------+++--++---+++-+-++--+--+-+----+------\ || || |         || | |    |  | |   |  |)",
R"(         |  \++----+--++--+--++--------+-+-------++---+------+-++-------/||  ||   ||| | ||  |  | |    |      | || || |         || | |    |  | |   |  |)",
R"(         |   ||    |  ||  |  ||        \-+-------++---/      | ||        ||  ||   ||| | ||  |  | \----+------+-++-++-+---------++-+-+----+--+-+---+--/)",
R"(         |   ||    |  ||  |  ||          |     /-++>---------+-++--------++--++---+++-+-++--+--+------+-\    | || || |         || | |    |  | |   |   )",
R"(         |   ||    |  ||  |  ||          |     | ||          | ||        ||  ||  /+++-+-++--+--+------+-+----+\|| || |         || | |    |  | |   |   )",
R"(         |   ||/---+--++--+--++----------+-----+-++------\   | ||        ||/-++--++++-+-++--+--+------+-+----++++-++-+--------\|| | |    |  | |   |   )",
R"(         |   |||   |  ||  |  ||          |     | ||      |   | ||        ||| ||  |||| | ||  |  |      | |    |||| || |        ||| v |    |  | |   |   )",
R"(         |   |||   |  ||  |  \+----------+--->-+-++------+---+-++--------+++-/|  |||| | ||  |  |      | |/---++++-++-+-------\||| | |    |  | |   |   )",
R"(         |   |||   |  |\--+---+----------+-----+-++------+---+-++--------+++--+--++++-+-++--+--+------+-++---++++-+/ |       |||| | |    |  | |   |   )",
R"(         |   |||   |  |   |   |          |     | ||      |   | ||        |||  |  |||\-+-++--+--+------+-++---++++-+--+-------++++-+-+----+--/ |   |   )",
R"(         |   |||   |  |   \---+----------+-----+-++------+---+-+/        |||  |  |||  \-++--+--+------+-++---++++-/  |       |||| | |    |    |   |   )",
R"(      /--+---+++---+--+-------+----------+--\  | ||      |   | |         |||  |  ||\----++--+--/      | ||   ||||    |       |||| | |    |    |   |   )",
R"(      |  |   |||   |  |       \----------+--+--+-++------+---+-+---------+++--+--++-----++--+---------+-++---++++----+-------++/| | |    |    |   |   )",
R"(      |  |   |||   |  \------------------+--+--+-++------+---+-+---------+++--+--++-----++--+---------+-++---+++/    |       || | | |    |    |   |   )",
R"(      |  |   |||   |                     |  |  | ||      |   | |         |||  |  \+-----++--+---------+-++---+/|     |       || | | |    |    |   |   )",
R"(      |  |   ||\---+---------------------+--+--+-++------/   | |         |||  \---+-----/|  \---------+-++---+-+-----+-------++-+-+-+----/    |   |   )",
R"(      |  |   ||    \---------------------+--+--+-++----------+-+---------+++------+------+------------+-++---/ |     |       || | | |         |   |   )",
R"(      |  |   ||                          |  |  \-++----------+-+---------+++------+------+------------+-/|     |     |       || | | |         |   |   )",
R"(      |  \---++--------------------------/  |    ||          \-+---------+++------+------+------------+--+-----+-----+-------++-+-/ |         |   |   )",
R"(      |      ||                             |    ||            |         |||      |      |            |  |     |     |       || |   |         |   |   )",
R"(      |      ||                             |    ||            |         \++------+------+------------+--+-----+-----+-------++-/   |         |   |   )",
R"(      |      |\-----------------------------+----++------------+----------++------/      |            |  |     |     |       ||     |         |   |   )",
R"(      \------+------------------------------/    ||            |          \+-------------+------------+--+-----+-----/       ||     |         |   |   )",
R"(             |                                   \+------------+-----------+-------------+------------/  \-----+-------------/|     |         |   |   )",
R"(             |                                    \------------+-----------+-------------+---------------------+--------------+-----/         |   |   )",
R"(             \-------------------------------------------------+-----------+-------------/                     \--------------+---------------+---/   )",
R"(                                                               |           \--------------------------------------------------/               |       )",
R"(                                                               \------------------------------------------------------------------------------/       )",

};


struct Cart
{
	int x, y;
	int nextIntersectionDir = 0; // 0, 1, 2; increment % 3
	int currentDir = 'v'; // v, <, >, ^
};


int m = 150, n = 151;

std::vector<Cart> carts;

int dirMap[256];


int main()
{
	dirMap['v'] = 0;
	dirMap['<'] = 1;
	dirMap['>'] = 2;
	dirMap['^'] = 3;
	dirMap[0] = 'v';
	dirMap[1] = '<';
	dirMap[2] = '>';
	dirMap[3] = '^';


	int dirSwitcher[4][3] = 
	{
		{ 2, 0, 1 },
		{ 0, 1, 3 },
		{ 3, 2, 0 },
		{ 1, 3, 2 }
	};

	int cornerSwitcher[4][256];
	
	cornerSwitcher[0]['/'] = 1;
	cornerSwitcher[1]['/'] = 0;
	cornerSwitcher[2]['/'] = 3;
	cornerSwitcher[3]['/'] = 2;
	cornerSwitcher[0]['\\'] = 2;
	cornerSwitcher[1]['\\'] = 3;
	cornerSwitcher[2]['\\'] = 0;
	cornerSwitcher[3]['\\'] = 1;




	for(int i = 0; i < m; i ++)
	{
		for(int j = 0; j <n; j++)
		{
			if(grid[i][j]== 'v' || grid[i][j] == '>' || grid[i][j] == '<' || grid[i][j] == '^')
			{
			    Cart cart;
			    cart.x = i;
			    cart.y = j;
			    cart.nextIntersectionDir = 0;
			    cart.currentDir =  dirMap[grid[i][j]];
				carts.push_back(cart);
				if(grid[i][j] == 'v' || grid[i][j] == '^')
					grid[i][j] = '|';
				if(grid[i][j] == '<' || grid[i][j] == '>')
					grid[i][j] = '-';
			}
		}
	}

	while(carts.size())
	{	
		std::sort(carts.begin(), carts.end(), [](const Cart& a, const Cart& b) { return a.x < b.x || a.x == b.x && a.y < b.y; });
		
		for(auto& cart : carts)
		{
			int deltaX = 0;
			int deltaY = 0;
			switch(cart.currentDir)
			{
				case 0:
				{
					deltaX = 1;
					deltaY = 0;
					break;
				}
				case 1:
				{
					deltaX = 0;
					deltaY = -1;
					break;
				}
				case 2:
				{
					deltaX = 0;
					deltaY = 1;
					break;
				}
				case 3:
				{
					deltaX = -1;
					deltaY = 0;
			 		break;
				}
			}
			
			int newX = cart.x + deltaX;
			int newY = cart.y + deltaY;
			
			auto it = std::find_if(carts.begin(), carts.end(), [newX, newY](const Cart& cart){ return cart.x == newX && cart.y == newY; });			
			if(it != carts.end())
			{
				std::cout << newY << ',' << newX << '\n';
				return 0;
			}

			int newDir = cart.currentDir;
			switch(grid[newX][newY])
			{
				case '+':
				{
					newDir = dirSwitcher[cart.currentDir][cart.nextIntersectionDir];
					cart.nextIntersectionDir = (cart.nextIntersectionDir + 1) % 3;
					break;
				}
				case '/':
				{
					newDir = cornerSwitcher[cart.currentDir]['/'];
					break;
				}
				case '\\':
				{
					newDir = cornerSwitcher[cart.currentDir]['\\'];
					break;
				}
			}

			cart.x = newX;
			cart.y = newY;
			cart.currentDir = newDir;
		}
	}
	return 0;

}
